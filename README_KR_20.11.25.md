Вариант 12. Поиск с имитацией отжига для раскраски графа
-
Задача: реализовать имитацию отжига для задачи раскраски графа с минимизацией числа
цветов.

**Требования:**

- Входные данные: неориентированный граф

- Выход: раскраска вершин и количество использованных цветов

- Вывести текущее число конфликтов при понижении температуры

Входные данные:

Граф с 10 вершинами и 15 ребрами


**Инициализация:**

Случайно присваиваем вершинам цвета.

Вычисляем начальное количество конфликтов (рёбер, соединяющих вершины одного цвета).

colors = [random.randint(0, k-1) for _ in range(n)]

conflicts = count_conflicts(adj_list, colors)

**Генерация соседнего решения:**

Случайно выбираем вершину и меняем её цвет.

Пересчитываем количество конфликтов.

vertex = random.randint(0, n-1)

old_color = colors[vertex]

new_color = random.choice([c for c in range(k) if c != old_color])

colors[vertex] = new_color

new_conflicts = count_conflicts(adj_list, colors)

**Критерий принятия решения (Метрополис):**

Если новое решение лучше (меньше конфликтов), принимаем его.

Иначе принимаем с вероятностью exp(-ΔE / T), где ΔE = new_conflicts - conflicts.

delta = new_conflicts - conflicts

if delta < 0 or random.random() < math.exp(-delta / temperature):

    conflicts = new_conflicts

else:

    colors[vertex] = old_color  # откат

**Охлаждение:**

Уменьшаем температуру по формуле: T = T * cooling_rate.

temperature *= cooling_rate

**Критерий остановки:**

Температура опускается ниже порога (например, 1e-6).

Временная сложность
-

**O(k * n * iterations)**

k — количество цветов,

n — число вершин,

iterations — общее число итераций (зависит от начальной температуры и коэффициента охлаждения).
Обоснование временной сложности (упрощенный вариант)

Формула временной сложности 
-
**O(k × n × I)**

**Как составляется формула:**

Внешний цикл по температуре:

Количество итераций охлаждения: I = log(T_start/T_end) / log(1/α)

Где α - коэффициент охлаждения

**Внутренние операции на каждой итерации:**

Выбор случайной вершины: O(1)

Выбор нового цвета: O(k) где k - количество цветов

Пересчет конфликтов для выбранной вершины: O(deg(v))

В лучшем случае, когда степень вершины мала: O(1)

Применение критерия Метрополиса: O(1)

**Итоговая сложность:**

Умножаем количество итераций I на стоимость одной итерации:

O(I × (1 + k + 1 + 1)) = O(I × k)

Учитывая, что в худшем случае k может достигать n, получаем:

O(I × k × n) в пересчете на все вершины

Таким образом, временная сложность линейно зависит от трех факторов: количества итераций, количества цветов и размера графа.

Ответ на контрольный вопрос
-
**12. Критерий Метрополиса
Какова формула критерия Метрополиса в алгоритме имитации отжига и что она означает?**

Формула критерия Метрополиса имеет следующий вид:


P(accept) = e^(-ΔE / T), где:

- ΔE = E_new - E_current (изменение энергии/качества решения)

- T - текущая температура

- P(accept) - вероятность принятия нового решения

**Физический смысл и происхождение:**

Критерий Метрополиса был заимствован из статистической физики, где он описывает вероятность перехода физической системы из одного энергетического состояния в другое при термических флуктуациях. В контексте имитации отжига "энергия" E соответствует значению целевой функции (например, количеству конфликтов в раскраске графа), а "температура" T является параметром, контролирующим вероятность принятия худших решений.

**Интерпретация формулы:**

Если ΔE < 0 (новое решение лучше текущего), то показатель степени становится положительным, и вероятность принятия P(accept) = 1. Это означает, что улучшающие решения всегда принимаются.
Если ΔE > 0 (новое решение хуже текущего), то вероятность принятия определяется экспоненциальным множителем. Чем больше ухудшение ΔE, тем меньше вероятность принять такое решение.
Роль температуры T является ключевой: при высоких температурах вероятность принятия худших решений значительна (экспонента медленно убывает), что позволяет алгоритму "прыгать" между локальными оптимумами и исследовать различные области пространства решений. По мере уменьшения температуры алгоритм становится более "жадным" - вероятность принятия ухудшающих ходов стремительно уменьшается, и поиск фокусируется на локальном улучшении в окрестности текущего решения.
Практическая значимость:
Критерий Метрополиса является фундаментальным механизмом, который отличает имитацию отжига от простого локального поиска. Без этой вероятностной компоненты алгоритм быстро застревал бы в первом же локальном оптимуме. Благодаря возможности временного ухудшения качества решения на ранних стадиях процесса, алгоритм способен избежать многих локальных минимумов и с большей вероятностью найти глобально оптимальное или близкое к нему решение.

Таким образом, критерий Метрополиса обеспечивает баланс между двумя противоречивыми целями оптимизации: исследованием неизученных областей пространства решений (exploration) и использованием найденных перспективных направлений (exploitation). Этот баланс постепенно смещается от доминирования исследования на начальных этапах к преобладанию использования на финальных стадиях алгоритма.
